<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QueueLess | Staff Dashboard</title>
  <link rel="stylesheet" href="/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>

<body>

  <div class="container">

    <header class="header">
      <h2><i class="fas fa-hospital-user" style="color: var(--primary); margin-right: 10px;"></i> Staff Portal</h2>
      <div style="display: flex; align-items: center; gap: 20px;">
        <span style="font-weight: 500;">Welcome, <span style="color: var(--secondary);">Dr. <%= name %></span></span>
        <a href="/logout" class="logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</a>
      </div>
    </header>

    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 30px;">
      <!-- Add Patient Form -->
      <div class="card" style="height: fit-content;">
        <h3 style="margin-bottom: 25px;"><i class="fas fa-user-plus" style="color: var(--primary);"></i> Register
          Patient</h3>
        <form method="POST" action="/queue/staff/add">
          <div class="input-group">
            <label>Patient Name</label>
            <input type="text" name="visitorName" placeholder="Full name" required>
          </div>
          <div class="input-group">
            <label>Purpose</label>
            <input type="text" name="purpose" placeholder="E.g. X-Ray, Lab" required>
          </div>
          <button type="submit" style="width: 100%;">
            <i class="fas fa-plus"></i> Add to Queue
          </button>
        </form>
      </div>

      <!-- Current Queue -->
      <div class="card">
        <h3 style="margin-bottom: 25px;"><i class="fas fa-list-ol" style="color: var(--secondary);"></i> Waiting Room
        </h3>

        <% if(!queue || queue.length===0){ %>
          <div style="text-align: center; padding: 40px; color: var(--text-muted);">
            <i class="fas fa-check-circle" style="font-size: 3rem; margin-bottom: 15px; opacity: 0.5;"></i>
            <p>The queue is currently empty.</p>
          </div>
          <% } else { %>
            <div class="queue-list">
              <% queue.forEach((v, index)=> { %>
                <div class="queue-item" style="animation-delay: <%= index * 0.1 %>s">
                  <div style="display: flex; align-items: center; gap: 15px;">
                    <div
                      style="width: 40px; height: 40px; background: var(--primary); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 1.2rem; color: white;">
                      <%= index + 1 %>
                    </div>
                    <div>
                      <div style="font-weight: 700; font-size: 1.1rem;">
                        <%= v.visitorName %>
                      </div>
                      <div style="font-size: 0.85rem; color: var(--text-muted);">
                        <%= v.purpose %>
                      </div>
                    </div>
                  </div>

                  <div style="display: flex; align-items: center; gap: 20px;">
                    <span class="time-badge">
                      <%= new Date(v.time).toLocaleTimeString([], {hour: '2-digit' , minute:'2-digit'}) %>
                    </span>
                    <form method="POST" action="/queue/serve/<%= v.id %>" style="margin: 0;">
                      <button type="submit"
                        style="margin: 0; padding: 8px 15px; background: var(--success); font-size: 0.9rem; color: white; border-radius: 10px;">
                        <i class="fas fa-check"></i> Serve
                      </button>
                    </form>
                  </div>
                </div>
                <% }) %>
            </div>
            <% } %>
      </div>
    </div>

  </div>

</body>

</html>